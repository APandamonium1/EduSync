name: Example
on:   
  push:
    branches: [main] # add with comma for more branches to monitor
  pull_request:
    branches: [main]

env:
  DATABASE_URL: ${{secrets.DATABASE_URL}}
  FIREBASE_ADMIN_PASSPHRASE: ${{secrets.FIREBASE_ADMIN_PASSPHRASE}}

jobs:
  example:
    name: Create Ubuntu OS
    runs-on: ubuntu-latest
    steps:
      - name: Setup Go
        uses: actions/setup-go@v5.0.1
        with:
          go-version: 1.22.3
          
      - name: Check Go Version
        run: go version

      - name: Checkout Repo   # to pull out current repo code
        uses: actions/checkout@v4.1.5

      - name: Install dependencies
        run: |
          #go mod init calc # for go mod. If we use go build, it will do the same for the 3 lines.
          go mod tidy
          go get github.com/franela/goblin
          ls
      
      - name: Decrypt large secret
        run: ./decrypt_secret.sh
        # This command is just an example to show your secret being printed
        # Ensure you remove any print statements of your secrets. GitHub does
        # not hide secrets that use this workaround. Let's hope this works.
      - name: Test printing your secret (Remove this step in production)
        run: cat $HOME/secrets/edusync-7bd5e-firebase-adminsdk-x49uh-af084a6314.json

      - name: Go Test
        run: |
          go test

      - if: ${{success()}}
        name: Success Message (Discord)
        uses: discord-actions/message@v2
        with:
          webhookUrl: https://discord.com/api/webhooks/1237964301201965127/ZYe3gYTeweYEfA_Q0I-JWFVXA2dVMp7Pw7jeNNd2UlFCtvIS8ZvIN_CRQ-gUwSgl7eD2
          message: SUCCESSFULLLL in branch ${{github.ref}} by ${{github.actor}}

      - if: ${{success()}}
        name: Success Message (Telegram)
        uses: akeylimepie/telegram-action@v0.1.2
        with: 
          token: 6795256205:AAHm19-9zOM4jMtEtVOSDGExXAtg5J67rKc
          chat_id: -4244340354
          text: SUCCESSFULLLL in branch ${{github.ref}} by ${{github.actor}}
          
      - if: ${{failure()}}
        name: Failure Message (Discord)
        uses: discord-actions/message@v2
        with:
          webhookUrl: https://discord.com/api/webhooks/1237964301201965127/ZYe3gYTeweYEfA_Q0I-JWFVXA2dVMp7Pw7jeNNd2UlFCtvIS8ZvIN_CRQ-gUwSgl7eD2
          message: FAILUREEEE in branch ${{github.ref}} by ${{github.actor}}

      - if: ${{failure()}}
        name: Failure Message (Telegram)
        uses: akeylimepie/telegram-action@v0.1.2
        with: 
          token: 6795256205:AAHm19-9zOM4jMtEtVOSDGExXAtg5J67rKc
          chat_id: -4244340354
          text: FAILUREEEE in branch ${{github.ref}} by ${{github.actor}}
      
      #- name: Setup Python
        #uses: actions/setup-python@v5.1.0
        #with:
          #python-version: 3.8
          
      #- name: Show Python Version
        #run: |
          #ls
          #python --version
          #ls
          #pip3 install pandas
    